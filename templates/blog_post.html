<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }} - Vidya Subodh</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1882984403181150"
     crossorigin="anonymous"></script>
    <style>
        body { font-family: 'Georgia', serif; line-height: 1.8; color: #333; background-color: #f7fafc; }
        .skip-link { position: absolute; top: -40px; left: 0; background: #000; color: white; padding: 8px; z-index: 100; transition: top 0.3s; }
        .skip-link:focus { top: 0; }
        
        /* Navbar Styling */
        .navbar { background: #fff; border-bottom: 1px solid #eee; padding: 15px 0; }
        .navbar-brand { font-size: 24px; color: #1a202c !important; }
        
        /* Content Area */
        .main-card { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .featured-image-container img { width: 100%; border-radius: 8px; margin-bottom: 30px; object-fit: cover; max-height: 500px; }
        
        /* Table of Contents */
        .toc-container { background: #f9f9f9; border: 1px solid #ddd; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .toc-title { font-weight: bold; font-size: 1.2rem; margin-bottom: 10px; color: #2b6cb0; }
        #toc-list { list-style: none; padding-left: 0; }
        #toc-list li { margin-bottom: 5px; }
        #toc-list a { text-decoration: none; color: #2b6cb0; font-weight: 500; }
        #toc-list .toc-h3 { padding-left: 20px; font-size: 0.95rem; }
        
        /* Post Content Formatting */
        .post-content { white-space: pre-wrap; word-wrap: break-word; font-size: 1.1rem; }
        .post-content p { margin-bottom: 1.5rem; white-space: normal; }
        .post-content h2, .post-content h3 { margin-top: 40px; font-weight: bold; font-family: 'Arial', sans-serif; color: #1a202c; }
        
        /* Table Support */
        .post-content table { width: 100%; border-collapse: collapse; margin: 25px 0; font-family: sans-serif; min-width: 400px; box-shadow: 0 0 20px rgba(0, 0, 0, 0.1); }
        .post-content table thead tr { background-color: #2b6cb0; color: #ffffff; text-align: left; }
        .post-content table th, .post-content table td { padding: 12px 15px; border: 1px solid #ddd; }
        .post-content table tbody tr:nth-of-type(even) { background-color: #f3f3f3; }

        .similar-post-card { border: none; transition: 0.3s; background: transparent; }
        .similar-post-card:hover { transform: translateY(-3px); }
        /* Horizontal Scroll Slider */
    .similar-posts-wrapper {
        display: flex;
        overflow-x: auto;
        gap: 1.5rem;
        padding-bottom: 15px;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch;
    }
    .similar-posts-wrapper::-webkit-scrollbar {
        height: 6px;
    }
    .similar-posts-wrapper::-webkit-scrollbar-thumb {
        background: #cbd5e0;
        border-radius: 10px;
    }
    .similar-card-item {
        flex: 0 0 75%; /* Shows 1.5 cards on mobile */
        scroll-snap-align: start;
    }
    @media (min-width: 768px) {
        .similar-card-item { flex: 0 0 30%; } /* Shows ~3 cards on desktop */
    }

    /* Internal Links Styling */
    .internal-links-box {
        background: #f8fafc;
        border-left: 4px solid #2b6cb0;
        padding: 20px;
        margin: 30px 0;
        border-radius: 0 8px 8px 0;
    }
    .internal-links-box a {
        display: block;
        color: #2b6cb0;
        font-weight: 600;
        margin-bottom: 10px;
        text-decoration: none;
    }
    .internal-links-box a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <a class="skip-link" href="#main-content">Skip to content</a>

    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="/">VIDYA SUBODH</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/privacy-policy">Privacy Policy</a></li>
                    <li class="nav-item"><a class="nav-link" href="/contact">Contact Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="/about">About Us</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-5" id="main-content">
        <div class="row justify-content-center">
            <div class="col-lg-9">
                <div class="main-card">
                    <p class="text-primary fw-bold small mb-1">{{ post.category }} | Blog</p>
                    <h1 class="fw-bold display-5 mb-3">{{ post.title }}</h1>
                    <p class="text-muted small mb-4">By <strong>vidyasubodh</strong> | {{ post.date }}</p>

                    {% if post.image %}
                    <div class="featured-image-container">
                        <img src="{{ post.image }}" alt="{{ post.title }}">
                    </div>
                    {% endif %}

                    <div class="toc-container">
                        <div class="toc-title">Table of Contents</div>
                        <ul id="toc-list"></ul>
                    </div>

                    <div class="post-content" id="post-body">
                        {{ post.content | safe }}
                    </div>

                    {% if similar_posts %}
<div class="internal-links-box">
    <h5 class="fw-bold mb-3">ðŸ”— Internal Links</h5>
    {% for s_link in similar_posts[:3] %}
    <a href="/blog/{{ s_link.slug }}">ðŸ‘‰ {{ s_link.title }}</a>
    {% endfor %}
</div>
{% endif %}

<hr class="my-5">

<h3 class="fw-bold mb-4">Similar Posts</h3>
<div class="similar-posts-wrapper">
    {% for s_post in similar_posts %}
    <div class="similar-card-item">
        <a href="/blog/{{ s_post.slug }}" class="text-decoration-none text-dark">
            <div class="card similar-post-card h-100">
                {% if s_post.image %}
                <img src="{{ s_post.image }}" class="card-img-top rounded" style="height:160px; object-fit:cover;">
                {% endif %}
                <div class="card-body px-0 py-2">
                    <h6 class="fw-bold small">{{ s_post.title }}</h6>
                </div>
            </div>
        </a>
    </div>
    {% endfor %}
</div>
                </div>
            </div>
        </div>
    </div>

    {% if show_timer %}
<div id="shortener-banner" style="position: fixed; top: 0; left: 0; width: 100%; background-color: #ffeb3b; color: black; text-align: center; padding: 15px; font-weight: bold; z-index: 9999; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
    You are on Step {{ shortener.step }} of {{ shortener.total_steps }}. Please wait <span id="shortener-timer">15</span> seconds...
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        let timeLeft = 15; // Set your timer duration here
        const timerEl = document.getElementById('shortener-timer');
        const bannerEl = document.getElementById('shortener-banner');
        
        // Create the button container (hidden at first)
        const btnContainer = document.createElement('div');
        btnContainer.style.textAlign = 'center';
        btnContainer.style.padding = '40px 20px';
        btnContainer.style.display = 'none';
        
        // Check if the user has reached the final step
        const currentStep = {{ shortener.step }};
        const totalSteps = {{ shortener.total_steps }};
        
        if (currentStep >= totalSteps) {
            // Final Step: Show the real target link
            btnContainer.innerHTML = '<a href="{{ shortener.target_url }}" style="padding: 15px 30px; background-color: #2196F3; color: white; text-decoration: none; font-size: 18px; border-radius: 5px; font-weight: bold;">Get Link</a>';
        } else {
            // Not the final step: Show Next button
            btnContainer.innerHTML = '<a href="/next_step" style="padding: 15px 30px; background-color: #4CAF50; color: white; text-decoration: none; font-size: 18px; border-radius: 5px; font-weight: bold;">Next Step</a>';
        }
        
        document.body.appendChild(btnContainer);

        const countdown = setInterval(function() {
            timeLeft--;
            timerEl.innerText = timeLeft;
            if (timeLeft <= 0) {
                clearInterval(countdown);
                bannerEl.innerText = currentStep >= totalSteps 
                    ? "Please scroll down to the bottom to get your link." 
                    : "Please scroll down to the bottom and click Next.";
                btnContainer.style.display = 'block';
            }
        }, 1000);
    });
</script>
{% endif %}

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const postBody = document.getElementById("post-body");
            const tocList = document.getElementById("toc-list");
            const headers = postBody.querySelectorAll("h2, h3");

            headers.forEach((header, index) => {
                const id = "section-" + index;
                header.setAttribute("id", id);

                const li = document.createElement("li");
                if (header.tagName.toLowerCase() === "h3") {
                    li.classList.add("toc-h3");
                }

                const link = document.createElement("a");
                link.setAttribute("href", "#" + id);
                link.textContent = header.textContent;

                li.appendChild(link);
                tocList.appendChild(li);
            });

            if (headers.length === 0) {
                document.querySelector(".toc-container").style.display = "none";
            }
        });
    </script>
    {% if show_timer %}
    <div id="shortener-banner" style="position: fixed; top: 0; left: 0; width: 100%; background-color: #ffeb3b; color: black; text-align: center; padding: 15px; font-weight: bold; z-index: 9999; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">
        You are on Step {{ shortener.step }} of {{ shortener.total_steps }}. Please wait <span id="shortener-timer">15</span> seconds...
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            let timeLeft = 15; // Set your timer duration here
            const timerEl = document.getElementById('shortener-timer');
            const bannerEl = document.getElementById('shortener-banner');
            
            // Create the button container (hidden at first)
            const btnContainer = document.createElement('div');
            btnContainer.style.textAlign = 'center';
            btnContainer.style.padding = '40px 20px';
            btnContainer.style.display = 'none';
            
            // Check if the user has reached the final step
            const currentStep = {{ shortener.step }};
            const totalSteps = {{ shortener.total_steps }};
            
            if (currentStep >= totalSteps) {
                // Final Step: Show the real target link
                btnContainer.innerHTML = '<a href="{{ shortener.target_url }}" style="padding: 15px 30px; background-color: #2196F3; color: white; text-decoration: none; font-size: 18px; border-radius: 5px; font-weight: bold;">Get Link</a>';
            } else {
                // Not the final step: Show Next button
                btnContainer.innerHTML = '<a href="/next_step" style="padding: 15px 30px; background-color: #4CAF50; color: white; text-decoration: none; font-size: 18px; border-radius: 5px; font-weight: bold;">Next Step</a>';
            }
            
            // Append the button to the main content area so it looks nice inside the white box
            document.getElementById('main-content').appendChild(btnContainer);

            const countdown = setInterval(function() {
                timeLeft--;
                timerEl.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(countdown);
                    bannerEl.innerText = currentStep >= totalSteps 
                        ? "Please scroll down to the bottom to get your link." 
                        : "Please scroll down to the bottom and click Next.";
                    btnContainer.style.display = 'block';
                }
            }, 1000);
        });
    </script>
    {% endif %}
</body>
</html>
